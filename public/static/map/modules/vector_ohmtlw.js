/**/_jsload2&&_jsload2('vector', 'x.extend(Ld.prototype,{ra:function(a,b){Dd.prototype.ra.call(this,a,b);this.Gg={};this.rr(a);this.Dq();this.Yq()},remove:function(){var a=this.D;Dd.prototype.remove.call(this);a&&(a.removeEventListener("zoomend",this.el),a.removeEventListener("moveend",this.Kk),a.removeEventListener("resize",this.Rk),a.removeEventListener("hotspotclick",this.kM),a.lm(this.k.Ik))},rr:function(a){this.D=a;this.aC=this.Pb;this.Ac=this.D.B.devicePixelRatio;this.zn=62;a.lm(this.k.Ik);for(var b in this.sp)delete this.sp[b]}, Dq:function(){var a=this,b=this.D;a.el=function(b){a.Yq(b)};a.Kk=function(b){a.Yq(b)};a.Rk=function(b){a.Yq(b)};a.kM=function(b){0<b.spots.length&&a.nU(b.spots[0].getUserData().uid)};b.addEventListener("zoomend",a.el);b.addEventListener("moveend",a.Kk);b.addEventListener("resize",a.Rk);b.addEventListener("hotspotclick",a.kM)},nU:function(a){var b=this,c=(1E5*Math.random()).toFixed(0);!B._rd&&(B._rd={});B._rd["_cbk"+c]=function(a){b.yR(a);delete B._rd["_cbk"+c]};var d=b.yW;this.k.hh&&(d=b.zW);a=d+ a+"?scope=2&ak="+this.k.bm+"&callback=BMap._rd._cbk"+c;this.k.hh&&(a+="&geotable_id="+this.k.hh);ra(a)},yR:function(a){var b=a.content;this.k.hh&&(b=a.contents[0]);if(a&&0==a.status&&b){var a={poiId:b.uid||"",databoxId:b.databox_id||"",title:this.k.hh?b.title:b.name,address:this.k.hh?b.address:b.addr,phoneNumber:b.tel||"",postcode:b.zip||"",provinceCode:1*b.province_id||-1,province:b.province||"",cityCode:1*b.city_id||-1,city:b.city||"",districtCode:1*b.district_id||-1,district:b.district||"",point:this.k.hh? new K(b.location[0],b.location[1]):new K(b.longitude,b.latitude),tags:b.tag&&b.tag.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,"").split(/\\s+/),typeId:1*b.cla||-1,extendedData:b.ext||{}},c=new N("onhotspotclick");c.customPoi=a;c.content=b;this.aG&&this.aG.dispatchEvent(c);this.dispatchEvent(c)}},Yq:function(){var a=this.D,b=a.ga(),c=a.gb.Lm(this.aC,"yun",this.zn);if(a.Wb()){this.Tm||(this.Tm=o,0<c.length&&(this.Ob=a.oa().k.Ob));this.ln=Math.pow(2,18-b);this.uh=c.length;a=0;for(b=c.length;a<b;a++)this.Gr(c[a][0], c[a][1],c[a][2])}},Gr:function(a,b,c){var d=this,e=d.map,f=e.wc(),g=new K(f.lng,f.lat),i=e.ga(),e=Od[Math.abs(a+b)%Od.length]+"/data?grids="+a+"_"+b+"_"+i+"&q="+this.k.hn+"&tags="+this.k.hz+"&filter="+this.k.filter+"&sortby="+this.k.bz+"&ak="+this.k.bm+"&age="+this.k.Iw,e=this.k.hh?e+("&geotable_id="+this.k.hh):e+("&databox_id="+this.k.SK);c.af=q;ra(e,function(e){var e=0==e.status?e.content[0].data:[],f=d.map,m=f.wc(),f=f.ga();m.ab(g)&&f==i&&(d.Zn(e,c,a,b,i),d.uh--,0==d.uh&&d.aG.dispatchEvent("oncustomlayerloaded"))})}, Zn:function(a,b,c,d,e){var f=b.getContext("2d");1<this.Ac&&!b.ng&&(f.scale(this.Ac,this.Ac),b.ng=o);b.$B||(b.$B=o,f.translate(this.zn/2,this.zn/2));for(var e="hotSpotTile_"+c+"_"+d+"_"+e,g=0,i=a.length;g<i;g++)this.PW(f,a[g],c,d,e,b)},PW:function(a,b,c,d,e,f){var g=this,i=b[0],k=b[1],l=b[2],m=b[3],g=this,n=this.Ob,b=this.ln,c=c*b*n,d=(d+1)*b*n;/^POINT\\((.*)\\)$/.test(l);var l=RegExp.$1.split(","),s=l[0],u=l[1],w=(s-c)/b,y=(d-u)/b,D=new Image;D.onload=function(){var b=this.width,c=this.height;a.drawImage(this, w-b/2,y-c);g.sp[e]||(b={userData:{name:i,uid:k},offsets:[c,b/2,0,b/2]},b=new kb(T.ub(new K(s,u)),b),g.D.Ew(b,g.k.Ik));setTimeout(function(){g.sp[e]=o;f.af=o},1E3);delete this.onload};this.dY(m,function(a){""==m&&(m="sid1");D.src=a&&a.content&&a.content[m]&&""!=a.content[m]?"data:image/png;base64,"+a.content[m]:I.pa+"madian.png"})},z4:function(){if(this.Pb){for(var a=this.Pb,b=0,c=a.childNodes.length;b<c;b++)a.childNodes[b].af=q;this.D.lm(this.k.Ik);for(var d in this.sp)delete this.sp[d];this.Yq()}}, dY:function(a,b){var c=this,d=this.k.SK,e=this.k.P_,f=this.k.bm;""==a&&(a="sid1");if(this.Gg[a]&&this.Gg[a].data)b(this.Gg[a].data);else{this.Gg[a]||(this.Gg[a]={},this.Gg[a].sC=[]);this.Gg[a].sC.push(b);var g=B.oc+"style/poi/rangestyle?method=getstyle";this.k.hh&&(d=this.k.hh);g+="&databox="+d+"&sid="+a+"&ak="+f;e&&(g+="&self_id="+e);this.Gg[a].NY||(setTimeout(function(){ra(g,function(b){var d=c.Gg[a].sC;c.Gg[a].data=b;for(var e=0;e<d.length;e++)d[e](b);c.Gg[a].sC.length=0})},10),c.Gg[a].NY=o)}}});x.extend(Md.prototype,{ra:function(a,b){Dd.prototype.ra.call(this,a,b);this.rr(a);this.Dq();this.ov()},remove:function(){var a=this.D;Dd.prototype.remove.call(this);a.removeEventListener("zoomend",this.el);a.removeEventListener("moveend",this.Kk);a.removeEventListener("resize",this.Rk)},rr:function(a){this.D=a;this.aC=this.Pb;this.Ac=this.D.B.devicePixelRatio;this.zn=0},Dq:function(){var a=this,b=this.D;a.el=function(b){a.ov(b)};a.Kk=function(b){a.ov(b)};a.Rk=function(b){a.ov(b)};b.addEventListener("zoomend", a.el);b.addEventListener("moveend",a.Kk);b.addEventListener("resize",a.Rk)},ov:function(){var a=this.D,b=a.gb.Lm(this.aC,"traffic",this.zn);this.Tm||(this.Tm=o,0<b.length&&(this.Ob=a.oa().k.Ob));for(var a=0,c=b.length;a<c;a++)this.Gr(b[a][0],b[a][1],b[a][2])},Gr:function(a,b,c){var d=this,e=d.map,f=e.wc(),g=new K(f.lng,f.lat),i=e.ga(),k="_t"+parseInt(a+""+b+""+i).toString(36),e=this.l0+"&x="+a+"&y="+b+"&z="+i+"&fn=BMap."+k+"&t="+(new Date).getTime();c.af=q;B[k]=function(e){var f=d.map,n=f.wc(),f= f.ga();n.ab(g)&&f==i&&e.content&&e.content.tf&&d.Zn(e.content.tf,c,a,b);delete B[k]};ra(e,q)},Zn:function(a,b){var c=b.getContext("2d"),d=this.we,e=this.Fx,f=this.Gx;1<this.Ac&&!b.ng&&(c.scale(this.Ac,this.Ac),b.ng=o);b.$B||(b.$B=o,c.translate(this.zn/2,this.zn/2));for(var g=0,i=a.length;g<i;g++){var k=a[g],l=k[1],m=this.Eb[k[3]],k=this.Eb[k[4]],n=l[0]/10,s=l[1]/10;c.beginPath();c.moveTo(n,s);for(var u=2,w=l.length;u<w;u+=2)n+=l[u]/10,s+=l[u+1]/10,c.lineTo(n,s);c.strokeStyle=d(m[1]);c.lineWidth=m[2]; c.lineCap=e(m[3]);c.lineJoin=f(m[4]);c.stroke();c.strokeStyle=d(k[1]);c.lineWidth=k[2];c.lineCap=e(k[3]);c.lineJoin=f(k[4]);c.stroke()}b.af=o},we:function(a){a>>>=0;return"rgba("+(a>>24&255)+","+(a>>16&255)+","+(a>>8&255)+","+(a&255)/256+")"},Fx:function(a){return["butt","square","round"][a]},Gx:function(a){return["miter","bevel","round"][a]}});x.extend(eb.prototype,{Ee:function(){this.ra(this.D,this.C)},ra:function(a,b){this.D=a;this.C=b;this.D&&this.C&&(this.rr(),this.$S(),this.Dq(),this.Xq())},remove:function(){var a=this.D;this.C.removeChild(this.Xa);a.removeEventListener("zoomend",this.el);a.removeEventListener("moving",this.nN);a.removeEventListener("moveend",this.Kk);a.removeEventListener("resize",this.Rk)},rr:function(){var a=this.D,b=a.B.devicePixelRatio,c=a.oa().k.Ob,d=a.vb(),a=d.width,d=d.height;this.di={};this.Ob=c;this.Ac=b; this.YE=a;this.XE=d;this.LC=a*b;this.KC=d*b},$S:function(){var a=this.D,b=this.C,c=document.createElement("canvas"),d=c.style;d.position="absolute";d.zIndex=5;d.left=-a.offsetX+"px";d.top=-a.offsetY+"px";d.width=this.YE+"px";d.height=this.XE+"px";c.setAttribute("width",this.LC);c.setAttribute("height",this.KC);b.appendChild(c);this.Xa=c;this.Mh=c.getContext("2d");a=this.Ac;1<a&&!c.ng&&(this.Mh.scale(a,a),c.ng=o)},Dq:function(){function a(){b.Xa.style.left=-c.offsetX+"px";b.Xa.style.top=-c.offsetY+ "px"}var b=this,c=b.D,d=b.Ac;b.el=function(c){b.Xa.style.display=18>this.ga()?"none":"block";a();b.Xq(c)};b.nN=function(c){var d=(new Date).getTime();100>d-b.JM||(b.JM=d,a(),b.Xq(c))};b.Kk=function(c){a();b.Xq(c)};b.Rk=function(e){var f=c.vb(),g=f.width,f=f.height,i=g*d,k=f*d;b.Xa.style.width=g+"px";b.Xa.style.height=f+"px";b.Xa.setAttribute("width",i);b.Xa.setAttribute("height",k);b.YE=g;b.XE=f;b.LC=i;b.KC=k;a();b.Xq(e)};c.addEventListener("zoomend",b.el);c.addEventListener("moving",b.nN);c.addEventListener("moveend", b.Kk);c.addEventListener("resize",b.Rk)},Xq:function(a){var b=this.D,c=b.ga();if(!(18>c)){var d=b.gb.IL(),e=d[0],b=d[1],f=d[2],d=d[3],a=a?q:o,g;for(g in this.di)for(var i=e;i<f;i++)for(var k=b;k<d;k++)g==i+"_"+k+"_"+c&&(this.di[g].oI=o);for(g in this.di)this.di[g].oI?delete this.di[g].oI:(this.di[g]=p,delete this.di[g]);this.Mh.clearRect(0,0,this.LC,this.KC);for(i=e;i<f;i++)for(k=b;k<d;k++)(g=this.di[i+"_"+k+"_"+c])?this.Zn(g,i,k,c,a):this.Gr(i,k,c,a)}},Gr:function(a,b,c,d){var e=this,f=e.D,g=e.JV, i=(a+b)%g.length,k="x="+a+"&y="+b+"&z="+c,l=f.ba.replace(/^TANGRAM_/,"")+"building"+parseInt(a+""+b+""+c).toString(36),g=g[i]+"qt=hjpgvd&"+k+"&styles=pl&layers=bg&features=bd&f=mwebapp&v=001&udt=20130501&fn=BMap."+l,i=f.wc(),m=new K(i.lng,i.lat),n=f.ga();B[l]=function(g){if(g=g.content){var i=f.wc(),k=f.ga();if(!i.ab(m)||k!=n){delete B[l];return}if(g=window.yZ(g))e.Zn(g,a,b,c,d),e.di[a+"_"+b+"_"+c]=g}delete B[l]};ra(g)},Zn:function(a,b,c,d,e){e&&this.k.uL?this.FR(a,b,c,d):this.DH(a,b,c,d,1)},FR:function(a, b,c,d){var e=this;a.rQ=new ub({Hc:50,duration:200,va:function(f){e.DH(a,b,c,d,f)},finish:function(){a.rQ=p}})},DH:function(a,b,c,d,e){var f=this.D,g=this.YE,i=this.XE,d=f.oa().yc(d),f=f.dc,k=this.Ob,b=b*k-f.lng/d,c=(-1-c)*k+f.lat/d,d=this.Mh,f=a.length,k=0,l=window.Eb;d.save();for(d.translate(b+g/2,c+i/2);k<f;k++){var m=a[k],n=l[m[3]];if(4==n[0]){var s=m[7];window.VectorDrawUtils.oD(d,m[1],6*(m[2]*n[3])*e,90*((b+(s[0]+s[2])/2)/(g/2)),90*((c+(s[1]+s[3])/2)/(i/2)),"rgba(212,205,197,1)","rgba(235,233,228,1)", "rgba(170,170,170,1)",1)}}d.restore()}}); ');
